# Date: 2025-09-30
## Topic: pg Package in Backend (Node.js + PostgreSQL)

### pg in Backend

The **`pg` package** is a popular Node.js library used for connecting your backend to a **PostgreSQL database**.

---

#### 1. What does it do?
- Connects your backend (Node.js/Express) to PostgreSQL.
- Lets you run SQL commands (`SELECT`, `INSERT`, `UPDATE`, `DELETE`).
- Manages database connections with pooling.

Example connection:

```js
const { Client } = require('pg');

const client = new Client({
  user: 'postgres',
  host: 'localhost',
  database: 'mydb',
  password: 'password123',
  port: 5432,
});

client.connect();
```

---

#### 2. Running Queries

```js
client.query('SELECT * FROM users', (err, res) => {
  if (err) {
    console.error(err);
  } else {
    console.log(res.rows);
  }
  client.end();
});
```

---

#### 3. Connection Pooling

```js
const { Pool } = require('pg');

const pool = new Pool({
  user: 'postgres',
  host: 'localhost',
  database: 'mydb',
  password: 'password123',
  port: 5432,
});

pool.query('SELECT * FROM products', (err, res) => {
  console.log(res.rows);
});
```

---

#### 4. The `res` Object in `pg`

⚠️ **Note**: This is not the same as Express's `res` (response) object.

- In `pg`, `res` means **result object** from PostgreSQL.

##### What’s inside `res`?
- **`res.rows`** → Array of rows (most important)
- **`res.rowCount`** → Number of rows returned/affected
- **`res.fields`** → Info about the columns
- **`res.command`** → Type of SQL command (`SELECT`, `INSERT`, etc.)

Example output:

```js
{
  command: 'SELECT',
  rowCount: 2,
  rows: [
    { id: 1, name: 'Hemanth' },
    { id: 2, name: 'Sumeet' }
  ],
  fields: [ ... ]
}
```

So when you do:

```js
console.log(res.rows);
```

Output:

```js
[
  { id: 1, name: 'Hemanth' },
  { id: 2, name: 'Sumeet' }
]
```

---

#### 5. Avoiding Confusion

To prevent mixing it with Express `res`, rename it:

```js
pool.query('SELECT * FROM users', (err, result) => {
  console.log(result.rows);
});
```

---

#### 6. In Short

`pg` = Node.js driver for PostgreSQL → lets your backend talk to the database, run queries, fetch results, and manage connections.
